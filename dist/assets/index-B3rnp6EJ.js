(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const N=document.querySelector("#fileInput"),w=document.querySelector(".dropzone"),m=document.querySelector("#imageList"),u=document.querySelector("#previewCanvas"),f=document.querySelector("#overlayCanvas"),X=document.querySelector("#canvasStage"),$=document.querySelector("#imageCount"),A=document.querySelector("#canvasSize"),j=document.querySelector("#previewLabel"),T=document.querySelector("#paddingInput"),q=document.querySelector("#alignSelect"),b=document.querySelector("#bgInput"),C=document.querySelector("#transparentToggle"),U=document.querySelector("#gridToggle"),F=document.querySelector("#nameInput"),k=document.querySelector("#frameSpeedInput"),O=document.querySelector("#toggleAnimBtn"),L=document.querySelector("#animCanvas"),Y=document.querySelector("#zoomOutBtn"),V=document.querySelector("#zoomInBtn"),B=document.querySelector("#zoomRange"),K=document.querySelector("#zoomValue"),Z=document.querySelector("#downloadBtn"),G=document.querySelector("#clearBtn"),_=document.querySelector("#emptyState");if(!N||!w||!m||!u||!f||!X||!$||!A||!j||!T||!q||!b||!C||!U||!F||!k||!O||!L||!Y||!V||!B||!K||!Z||!G||!_)throw new Error("Missing required elements");const v=u.getContext("2d");if(!v)throw new Error("2D context not supported");const l=f.getContext("2d");if(!l)throw new Error("2D context not supported");const x=L.getContext("2d");if(!x)throw new Error("2D context not supported");const a=[];let y=1,z=null,I=0,S=!0;const W=(e,t)=>{$.textContent=String(a.length),A.textContent=`${e} × ${t}`},D=e=>{j.textContent=e},te=()=>{v.clearRect(0,0,u.width,u.height)},H=()=>{l.clearRect(0,0,f.width,f.height)},P=()=>{x.clearRect(0,0,L.width,L.height)},R=()=>{if(a.length===0){P();return}const e=a[I%a.length],t=L.width,n=L.height;P(),C.checked||(x.fillStyle=b.value,x.fillRect(0,0,t,n));const s=Math.max(...a.map(d=>d.width)),o=Math.max(...a.map(d=>d.height)),r=(t-s)/2,c=(n-o)/2,h=r+(s-e.width)/2+e.offsetX,i=c+(o-e.height)/2;x.drawImage(e.image,h,i,e.width,e.height)},J=()=>{const e=Math.max(20,Number(k.value)||150);z&&window.clearInterval(z),z=window.setInterval(()=>{S&&(I=(I+1)%Math.max(1,a.length),R())},e)},M=e=>{y=Math.min(2,Math.max(.25,e)),X.style.transform=`scale(${y})`,B.value=String(Math.round(y*100)),K.textContent=`${Math.round(y*100)}%`},g=()=>{if(a.length===0){u.width=0,u.height=0,f.width=0,f.height=0,te(),H(),W(0,0),D("Waiting for images"),_.style.opacity="1";return}const e=Math.max(0,Number(T.value)||0),t=Math.max(...a.map(i=>i.height)),s=Math.max(...a.map(i=>i.width)),o=t,r=s*a.length+e*(a.length+1),c=o+e*2;u.width=r,u.height=c,f.width=r,f.height=c,C.checked?v.clearRect(0,0,r,c):(v.fillStyle=b.value,v.fillRect(0,0,r,c)),H();let h=e;for(const i of a){const d=o;let p=e;q.value==="center"&&(p=e+(d-i.height)/2),q.value==="bottom"&&(p=e+(d-i.height));const ee=h+(s-i.width)/2+i.offsetX;v.drawImage(i.image,ee,p,i.width,i.height),h+=s+e}if(U.checked){l.save(),l.strokeStyle="rgba(37, 99, 235, 0.6)",l.lineWidth=1,l.setLineDash([6,6]);const i=s+e;for(let d=0;d<=a.length;d+=1){const p=d*i;l.beginPath(),l.moveTo(p,0),l.lineTo(p,c),l.stroke()}l.beginPath(),l.rect(0,0,r,c),l.stroke(),l.restore()}W(r,c),D("Ready to download"),_.style.opacity="0",R()},ne=async e=>{const t=URL.createObjectURL(e),n=new Image;n.src=t,await n.decode();const s={id:crypto.randomUUID(),file:e,url:t,image:n,width:n.naturalWidth,height:n.naturalHeight,offsetX:0};a.push(s),E(),g()},oe=e=>{const t=a.findIndex(s=>s.id===e);if(t===-1)return;const[n]=a.splice(t,1);URL.revokeObjectURL(n.url),E(),g()},E=()=>{if(m.innerHTML="",a.length===0){m.innerHTML='<div class="list__empty">No images yet. Upload a few files to get started.</div>';return}for(const e of a){const t=document.createElement("div");t.className="list__item",t.draggable=!0,t.dataset.id=e.id;const n=document.createElement("img");n.src=e.url,n.alt=e.file.name;const s=document.createElement("div");s.className="meta",s.innerHTML=`
      <strong>${e.file.name}</strong>
      <span>${e.width} × ${e.height}px</span>
    `;const o=document.createElement("label");o.className="offset",o.innerHTML=`
      <span>Offset X</span>
      <input type="number" value="${e.offsetX}" step="1" />
    `;const r=o.querySelector("input");r==null||r.addEventListener("input",h=>{const i=h.target,d=Number(i.value);e.offsetX=Number.isFinite(d)?d:0,g()});const c=document.createElement("button");c.className="ghost",c.type="button",c.textContent="Remove",c.addEventListener("click",()=>oe(e.id)),t.append(n,s,o,c),m.append(t)}},Q=async e=>{if(!e||e.length===0)return;const t=Array.from(e);for(const n of t)n.type.startsWith("image/")&&await ne(n);N.value="",I=0,R()};N.addEventListener("change",e=>{const t=e.target;Q(t.files)});["dragenter","dragover"].forEach(e=>{w.addEventListener(e,t=>{t.preventDefault(),w.classList.add("dropzone--active")})});["dragleave","drop"].forEach(e=>{w.addEventListener(e,t=>{t.preventDefault(),w.classList.remove("dropzone--active")})});w.addEventListener("drop",e=>{const t=e.dataTransfer;Q((t==null?void 0:t.files)??null)});[T,q,b,C].forEach(e=>{e.addEventListener("input",()=>g())});[U].forEach(e=>{e.addEventListener("input",()=>g())});k.addEventListener("input",()=>{J()});O.addEventListener("click",()=>{S=!S,O.textContent=S?"Pause":"Play",S&&R()});B.addEventListener("input",e=>{const t=e.target,n=Number(t.value)/100;M(n)});Y.addEventListener("click",()=>{M(y-.1)});V.addEventListener("click",()=>{M(y+.1)});m.addEventListener("dragstart",e=>{var s;const n=e.target.closest(".list__item");n&&(n.classList.add("dragging"),(s=e.dataTransfer)==null||s.setData("text/plain",n.dataset.id??""))});m.addEventListener("dragend",e=>{const n=e.target.closest(".list__item");n==null||n.classList.remove("dragging")});m.addEventListener("dragover",e=>{e.preventDefault();const n=e.target.closest(".list__item");n&&n.classList.add("drag-over")});m.addEventListener("dragleave",e=>{const n=e.target.closest(".list__item");n==null||n.classList.remove("drag-over")});m.addEventListener("drop",e=>{var i;e.preventDefault();const n=e.target.closest(".list__item");if(!n)return;n.classList.remove("drag-over");const s=(i=e.dataTransfer)==null?void 0:i.getData("text/plain"),o=n.dataset.id;if(!s||!o||s===o)return;const r=a.findIndex(d=>d.id===s),c=a.findIndex(d=>d.id===o);if(r===-1||c===-1)return;const[h]=a.splice(r,1);a.splice(c,0,h),E(),g()});G.addEventListener("click",()=>{for(;a.length;){const e=a.pop();e&&URL.revokeObjectURL(e.url)}E(),g()});Z.addEventListener("click",()=>{a.length!==0&&(g(),u.toBlob(e=>{if(!e)return;const t=document.createElement("a"),n=F.value.trim()||"spritesheet";t.href=URL.createObjectURL(e),t.download=`${n}.png`,t.click(),URL.revokeObjectURL(t.href)},"image/png"))});E();g();M(1);J();
